@using BackOffice.Translates
@model BackOffice.Areas.Users.Models.UsersManagementIndexViewModel

<h1>@Phrases.Users</h1>
<table class="table table-striped">
    <thead>
    <tr>
        <th>Email</th>
        <th>@Phrases.FullName</th>
        <th>@Phrases.Roles</th>
        <th>TwoFactAuth<br/>(Use,Binded)</th>
        <th>Admin</th>
        <th></th>
    </tr>
    </thead>
    <tbody>
    @foreach (var user in Model.Users)
    {
        <tr class="@(user.IsDisabled ? "disabled-user" : "")">
            <td>
                @user.Id
            </td>
            <td>
                @user.FullName
            </td>
            <td>
                @foreach (var role in user.Roles)
                {
                    <span class="badge">@(Model.Roles.ContainsKey(role) ? Model.Roles[role].Name : role)</span>
                }
            </td>
            <td>
                @if (user.UseTwoFactorVerification)
                {<span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span>

                }
                else
                {
                    <span class="glyphicon glyphicon-unchecked" aria-hidden="true"></span>
                }
                <span> </span>
                @if (user.GoogleAuthenticatorConfirmBinding)
                {<span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span>

                }
                else
                {
                    <span class="glyphicon glyphicon-unchecked" aria-hidden="true"></span>
                }
            </td>
            <td>
                @if (user.IsAdmin)
                {<span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span>

                }
                else
                {
                    <span class="glyphicon glyphicon-unchecked" aria-hidden="true"></span>
                }
            </td>

            <td>
                @if (Model.IsCurrentUserAdmin && user.Id != Model.DefaultAdminEmail)
                {
                    <button class="btn btn-success btn-xs" onclick="ui.showDialog('@Url.Action("EditUserDialog")', { id:'@user.Id' });">
                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                    </button>
                    <button class="btn btn-warning btn-xs" onclick="ui.showDialog('@Url.Action("LogoutUserDialog")', { id:'@user.Id' });">
                        <span class="glyphicon glyphicon-log-out" aria-hidden="true"></span>
                    </button>
                    @if (user.IsDisabled)
                    {
                        <button class="btn btn-success btn-xs" onclick="ui.showDialog('@Url.Action("EnableUserDialog")', { id: '@user.Id' });">
                            <span class="glyphicon glyphicon-play" aria-hidden="true"></span>
                        </button>
                    }
                    else
                    {
                        <button class="btn btn-warning btn-xs" onclick="ui.showDialog('@Url.Action("DisableUserDialog")', { id: '@user.Id' });">
                            <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
                        </button>
                    }
                    <button class="btn btn-danger btn-xs" onclick="ui.showDialog('@Url.Action("RemoveUserDialog")', { id:'@user.Id' });">
                        <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span>
                    </button>
                }
            </td>
        </tr>
  
    }
        
    @if (Model.IsCurrentUserAdmin)
    {
        <tr>
            <td colspan="4">

            </td>
            <td>
                <button class="btn btn-info btn-xs" onclick="ui.showDialog('@Url.Action("EditUserDialog")');"><span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span></button>
            </td>
        </tr>
    }
    </tbody>
</table>